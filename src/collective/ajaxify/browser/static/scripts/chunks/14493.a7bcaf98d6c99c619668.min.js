"use strict";(self.webpackChunkcollective_ajaxify=self.webpackChunkcollective_ajaxify||[]).push([[14493],{14493:function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});var r=n(35686),i=n.n(r);class o{constructor(e){this.el=e}createReplyForm(e){var t=e.attr("id"),n=e.find(".reply-to-comment-button"),r=i()("#commenting").clone(!0);r.find("#formfield-form-widgets-captcha").find("script").remove(),r.appendTo(e).css("display","none"),r.removeAttr("id"),i()(n).css("display","none");var o=r.find("form");o.find("#formfield-form-widgets-comment-text").attr("id","formfield-form-widgets-new-textarea"+t),o.find("#form-widgets-comment-text").attr("id","form-widgets-new-textarea"+t),o.find('input[name="form.widgets.in_reply_to"]').val(t);var a=r.find(".cancelreplytocomment");a.attr("id",t),o.find('input[name="form.buttons.cancel"]').css("display","inline"),r.slideDown("slow"),a.css("display","inline")}clearForm(e){e.find(".error").removeClass("error"),e.find(".fieldErrorBox").remove(),e.find('input[type="text"]').attr("value",""),e.find("textarea").attr("value","")}init_comment_eventhandler(){i()('input[name="form.button.TransmitComment"]').on("click",e=>{e.preventDefault();const t=e.currentTarget,n=i()(t),r=n.parents("form"),o=i()(r),a=o.serialize(),l=o.attr("action"),s=n.parents(".comment").attr("id");return i().ajax({type:"GET",url:l,data:a,context:t,success:()=>{let e=location.href;n.parents(".comment").load(`${e} #${s}.comment`,()=>{n.find(".comment").unwrap(),this.init_comment_eventhandler(),i()(".pat-plone-modal").patPloneModal()})},error:()=>!0}),!1}),i().fn.prepOverlay&&i()('form[name="edit"]').prepOverlay({cssclass:"overlay-edit-comment",width:"60%",subtype:"ajax",filter:"#content>*"}),i()('input[name="form.button.DeleteComment"]').on("click",function(e){e.preventDefault();var t=i()(this).parents("form"),n=i()(t).serialize(),r=i()(t).attr("action");return i().ajax({type:"POST",url:r,data:n,context:i()(this).parents(".comment"),success:function(){for(var e=i()(this),t=e.attr("class"),n=parseInt(t[t.indexOf("replyTreeLevel")+14],10),r=".replyTreeLevel"+n,o=0;o<n;o++)r+=", .replyTreeLevel"+o;e.nextUntil(r).each(function(){i()(this).fadeOut("fast",function(){i()(this).remove()})}),e.prev('[class*="replyTreeLevel'+(n-1)+'"]').find('form[name="delete"]').css("display","inline"),i()(this).fadeOut("fast",function(){i()(this).remove()})},error:function(){return!0}}),!1})}init(){let e=this;e.init_comment_eventhandler();var t=i()("#commenting"),n=t.find('input[name="form.widgets.in_reply_to"]');if(0!==n.length&&""!==n.val()){var r="#"+n.val(),o=i()(".discussion").find(r);e.createReplyForm(o),e.clearForm(t)}i()(".reply-to-comment-button").on("click",function(){var t=i()(this).parents().filter(".comment");e.createReplyForm(t),e.clearForm(t)}),i()("#commenting #form-buttons-cancel").on("click",function(t){t.preventDefault();var n=i()(this).parents().filter(".comment").find(".reply-to-comment-button");e.reply_to_comment_form=i()(this).parents().filter(".reply"),e.reply_to_comment_form.slideUp("slow",function(){i()(this).remove()}),n.css("display","inline")}),i()(".reply").find('input[name="form.buttons.reply"]').css("display","none"),i()(".reply").find('input[name="form.buttons.cancel"]').css("display","none"),i()(".reply-to-comment-button").removeClass("hide")}}}}]);
//# sourceMappingURL=14493.a7bcaf98d6c99c619668.min.js.map