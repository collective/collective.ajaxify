"use strict";(self.webpackChunkcollective_ajaxify=self.webpackChunkcollective_ajaxify||[]).push([[19983],{19983:function(t,e,n){n.r(e),n.d(e,{CodeJar:function(){return r}});const o=window;function r(t,e,n={}){const r=Object.assign({tab:"\t",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:o},n),i=r.window,s=i.document;let d,a,l=[],c=[],f=-1,u=!1;t.setAttribute("contenteditable","plaintext-only"),t.setAttribute("spellcheck",r.spellcheck?"true":"false"),t.style.outline="none",t.style.overflowWrap="break-word",t.style.overflowY="auto",t.style.whiteSpace="pre-wrap";let p=!1;e(t),"plaintext-only"!==t.contentEditable&&(p=!0),p&&t.setAttribute("contenteditable","true");const h=A(()=>{const n=T();e(t,n),b(n)},30);let g=!1;const y=t=>!O(t)&&!M(t)&&"Meta"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&!t.key.startsWith("Arrow"),C=A(t=>{y(t)&&(v(),g=!1)},300),N=(e,n)=>{l.push([e,n]),t.addEventListener(e,n)};function T(){const e=K(),n={start:0,end:0,dir:void 0};let{anchorNode:o,anchorOffset:r,focusNode:i,focusOffset:d}=e;if(!o||!i)throw"error1";if(o===t&&i===t)return n.start=r>0&&t.textContent?t.textContent.length:0,n.end=d>0&&t.textContent?t.textContent.length:0,n.dir=d>=r?"->":"<-",n;if(o.nodeType===Node.ELEMENT_NODE){const t=s.createTextNode("");o.insertBefore(t,o.childNodes[r]),o=t,r=0}if(i.nodeType===Node.ELEMENT_NODE){const t=s.createTextNode("");i.insertBefore(t,i.childNodes[d]),i=t,d=0}return w(t,t=>{if(t===o&&t===i)return n.start+=r,n.end+=d,n.dir=r<=d?"->":"<-","stop";if(t===o){if(n.start+=r,n.dir)return"stop";n.dir="->"}else if(t===i){if(n.end+=d,n.dir)return"stop";n.dir="<-"}t.nodeType===Node.TEXT_NODE&&("->"!=n.dir&&(n.start+=t.nodeValue.length),"<-"!=n.dir&&(n.end+=t.nodeValue.length))}),t.normalize(),n}function b(e){const n=K();let o,r,i=0,s=0;if(e.dir||(e.dir="->"),e.start<0&&(e.start=0),e.end<0&&(e.end=0),"<-"==e.dir){const{start:t,end:n}=e;e.start=n,e.end=t}let d=0;w(t,t=>{if(t.nodeType!==Node.TEXT_NODE)return;const n=(t.nodeValue||"").length;if(d+n>e.start&&(o||(o=t,i=e.start-d),d+n>e.end))return r=t,s=e.end-d,"stop";d+=n}),o||(o=t,i=t.childNodes.length),r||(r=t,s=t.childNodes.length),"<-"==e.dir&&([o,i,r,s]=[r,s,o,i]),n.setBaseAndExtent(o,i,r,s)}function k(){const e=K().getRangeAt(0),n=s.createRange();return n.selectNodeContents(t),n.setEnd(e.startContainer,e.startOffset),n.toString()}function E(){const e=K().getRangeAt(0),n=s.createRange();return n.selectNodeContents(t),n.setStart(e.endContainer,e.endOffset),n.toString()}function m(t){if(p&&"Enter"===t.key)if(H(t),t.stopPropagation(),""==E()){L("\n ");const t=T();t.start=--t.end,b(t)}else L("\n")}function v(){if(!u)return;const e=t.innerHTML,n=T(),o=c[f];if(o&&o.html===e&&o.pos.start===n.start&&o.pos.end===n.end)return;f++,c[f]={html:e,pos:n},c.splice(f+1);f>300&&(f=300,c.splice(0,1))}function w(t,e){const n=[];t.firstChild&&n.push(t.firstChild);let o=n.pop();for(;o&&"stop"!==e(o);)o.nextSibling&&n.push(o.nextSibling),o.firstChild&&n.push(o.firstChild),o=n.pop()}function x(t){return t.metaKey||t.ctrlKey}function O(t){return x(t)&&!t.shiftKey&&"Z"===S(t)}function M(t){return x(t)&&t.shiftKey&&"Z"===S(t)}function S(t){let e=t.key||t.keyCode||t.which;if(e)return("string"==typeof e?e:String.fromCharCode(e)).toUpperCase()}function L(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),s.execCommand("insertHTML",!1,t)}function A(t,e){let n=0;return(...o)=>{clearTimeout(n),n=i.setTimeout(()=>t(...o),e)}}function D(t){let e=t.length-1;for(;e>=0&&"\n"!==t[e];)e--;e++;let n=e;for(;n<t.length&&/[ \t]/.test(t[n]);)n++;return[t.substring(e,n)||"",e,n]}function _(){return t.textContent||""}function H(t){t.preventDefault()}function K(){var e;return(null===(e=t.parentNode)||void 0===e?void 0:e.nodeType)==Node.DOCUMENT_FRAGMENT_NODE?t.parentNode.getSelection():i.getSelection()}return N("keydown",e=>{e.defaultPrevented||(a=_(),r.preserveIdent?function(t){if("Enter"===t.key){const e=k(),n=E();let[o]=D(e),i=o;if(r.indentOn.test(e)&&(i+=r.tab),i.length>0?(H(t),t.stopPropagation(),L("\n"+i)):m(t),i!==o&&r.moveToNewLine.test(n)){const t=T();L("\n"+o),b(t)}}}(e):m(e),r.catchTab&&function(t){if("Tab"===t.key)if(H(t),t.shiftKey){const t=k();let[e,n]=D(t);if(e.length>0){const t=T(),o=Math.min(r.tab.length,e.length);b({start:n,end:n+o}),s.execCommand("delete"),t.start-=o,t.end-=o,b(t)}}else L(r.tab)}(e),r.addClosing&&function(t){const e="([{'\"",n=")]}'\"",o=E(),r=k(),i="\\"===r.substr(r.length-1),s=o.substr(0,1);if(n.includes(t.key)&&!i&&s===t.key){const e=T();H(t),e.start=++e.end,b(e)}else if(e.includes(t.key)&&!i&&("\"'".includes(t.key)||[""," ","\n"].includes(s))){H(t);const o=T(),r=o.start==o.end?"":K().toString();L(t.key+r+n[e.indexOf(t.key)]),o.start++,o.end++,b(o)}}(e),r.history&&(!function(e){if(O(e)){H(e),f--;const n=c[f];n&&(t.innerHTML=n.html,b(n.pos)),f<0&&(f=0)}if(M(e)){H(e),f++;const n=c[f];n&&(t.innerHTML=n.html,b(n.pos)),f>=c.length&&f--}}(e),y(e)&&!g&&(v(),g=!0)),p&&!function(t){return x(t)&&"C"===S(t)}(e)&&b(T()))}),N("keyup",t=>{t.defaultPrevented||t.isComposing||(a!==_()&&h(),C(t),d&&d(_()))}),N("focus",t=>{u=!0}),N("blur",t=>{u=!1}),N("paste",n=>{v(),function(n){H(n);const o=(n.originalEvent||n).clipboardData.getData("text/plain").replace(/\r/g,""),r=T();L(o),e(t),b({start:Math.min(r.start,r.end)+o.length,end:Math.min(r.start,r.end)+o.length,dir:"<-"})}(n),v(),d&&d(_())}),{updateOptions(t){Object.assign(r,t)},updateCode(n){t.textContent=n,e(t)},onUpdate(t){d=t},toString:_,save:T,restore:b,recordHistory:v,destroy(){for(let[e,n]of l)t.removeEventListener(e,n)}}}}}]);
//# sourceMappingURL=19983.4b01872a1af385ae075b.min.js.map